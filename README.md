<h1 align="center">
  <img src="./img/repo/COMET-DP.png" alt="EQO" width="200">
  <br>
  COMET: A Differential Privacy Context Obfuscation MEchanism for Textual Data
  <br>
</h1>

<h4 align="center">Anonymous COMET repository for double-blind revisions of Short-Paper submitted at <a href="https://www.cikm2025.org/" target="_blank">CIKM'25</a>. ID Paper: </h4>

<p align="center">
  <a href="https://img.shields.io/badge/license-GNU_GPL_3.0-blue.svg">
    <img src="https://img.shields.io/badge/license-GNU_GPL_3.0-blue.svg" alt="License">
  </a>
  <a href="https://img.shields.io/badge/python-3.10%2B-blue.svg">
    <img src="https://img.shields.io/badge/python-3.10%2B-blue.svg" alt="Python Version">
  </a>
  <a href="https://img.shields.io/badge/conda-24%2B-blue.svg">
    <img src="https://img.shields.io/badge/conda-24%2B-blue.svg" alt="Conda Version">
  </a>
  <a href="https://img.shields.io/badge/OS-Linux%20%7C%20Windows%20%7C%20MacOS-lightgrey.svg">
    <img src="https://img.shields.io/badge/OS-Linux%20%7C%20Windows%20%7C%20MacOS-lightgrey.svg" alt="OS">
  </a>
  <a href="https://img.shields.io/badge/status-release-green.svg">
    <img src="https://img.shields.io/badge/status-release_1.0.0-green.svg" alt="Release Version">
  </a>
</p>

## ðŸ“‚ Directory Structure
```bash
â”œâ”€â”€ config
â”‚   â”œâ”€â”€ environment.yml
â”‚   â”œâ”€â”€ requirements.txt
â”œâ”€â”€ data
â”‚   â”œâ”€â”€ IR
â”‚      â”œâ”€â”€ effectiveness
â”‚      â”œâ”€â”€ obfuscatedQueries
â”‚      â”œâ”€â”€ privacy
â”‚   â”œâ”€â”€ sentimentAnalysis
â”‚      â”œâ”€â”€ effectiveness
â”‚      â”œâ”€â”€ obfuscatedQueries
â”‚      â”œâ”€â”€ privacy
â”œâ”€â”€ img
â”‚   â”œâ”€â”€ repo
â”œâ”€â”€ logs # Directory for storing logs dinamically generated by the script
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ dp-comet.py
â”‚   â”œâ”€â”€ utils
â”‚      â”œâ”€â”€ __init__.py
â”‚      â”œâ”€â”€ mylogger.py
â”œâ”€â”€ test
â”œâ”€â”€ README.md
â”œâ”€â”€ LICENSE
â”œâ”€â”€ .gitignore
```
The `main.py` script will generate a sample test folder, apply the COMET mechanism, perform the experiments and store the results in it. The results logs will be saved in the `logs/` folder.

## ðŸŒ Setup Environment
1. Clone the repository

2. Generate the environment using the `environment.yml` file in `./config/` folder. You can use the following command to create a conda environment:
```bash
conda env create -f config/environment.yml
```
Then verify the environment:
```bash
conda env list
```

3. Activate the environment:
```bash
conda activate dp-comet
```

Now you can run the code in the repository with all the dependencies installed. Once you are done, you can deactivate the environment:
```bash
conda deactivate
```

In the `./config/requirements.txt` file, you can find the list of packages used in the project. 

## ðŸ§ª Test COMET

> [!WARNING]
Due to the large size of the embeddings, the config folder does not contain the file used by COMET. However, upon acceptance of the paper, the embeddings will be provided in the de-anonymized repository. If you want to test the COMET mechanisms, you can use the `main.py` script to generate the obfuscated queries, but the time will be longer than the one reported in the paper, as the embeddings will be generated on-the-fly.

To test the contextual obfuscation mechanism, you can use the `main.py` script and run the following command:
```bash
python3 main.py
```

An example with the obfuscated queries for the Information Retrieval task is shown below:
```bash
python3 main.py --collection dl20 --iterations 10 --mechanism CMP --epsilons 4 16
```

![demo](img/repo/demo.gif)


## Effectiveness & Privacy
The results can be found in the `data/` folder, where you will find the obfuscated queries and the results of the experiments. The results are organized in subfolders for each task, such as `IR` (Information Retrieval) and `sentimentAnalysis`, with further subfolders for effectiveness, obfuscated queries, and privacy.

## Efficiency
The COMET mechanism is designed to be efficient in terms of computational resources. The tests has been performed on a machine with the following specifications:
```bash
Processor: 13th Gen Intel i9-13900H (20) @ 5.200GHz
GPU: Intel Raptor Lake-P [Iris Xe Graphics]
RAM: 16 GB
Storage: 1 TB SSD
Operating System: Ubuntu 24.04.2 LTS x86_64
```
The `btop` screenshot below shows the CPU and RAM usage during the execution of the `main.py` script:

![btop](img/repo/btop.png)


## ðŸ†˜ Support
More Information about Author(s) and Support of the Mechanism released upon acceptance of the paper due to double-anonymous review process.

## ðŸ“œ License
This project is licensed under the GNU General Public License v3.0. See the [LICENSE](LICENSE) file for details.

---

> [Anonymous Author(s)](https://github.com/) &nbsp;&middot;&nbsp;
> GitHub [@Anonymous_Author(s)](https://github.com/)